// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model Empleado {
  nombre_empleado   String
  correo_empleado   String    @id @unique
  telefono_empleado String    @unique
  password_empleado String
  Creador           Creador[]
  Editor            Editor[]
  Edicion           Edicion[]
}

model Empresa {
  nombre_empresa   String
  correo_empresa   String    @id @unique
  telefono_empresa String    @unique
  Cliente          Cliente[]
  Modelo           Modelo[]
}

model Cliente {
  nombre_cliente   String
  correo_cliente   String     @id @unique
  telefono_cliente String     @unique
  correo_empresa   String
  empresa          Empresa    @relation(fields: [correo_empresa], references: [correo_empresa])
  Modelo           Modelo[]
  Peticion         Peticion[]
}

model Creador {
  correo_creador String   @id @unique
  empleado       Empleado @relation(fields: [correo_creador], references: [correo_empleado])
  Modelo         Modelo[]
}

model Editor {
  correo_editor     String              @id @unique
  empleado          Empleado            @relation(fields: [correo_editor], references: [correo_empleado])
  EditoresDeModelos EditoresDeModelos[]
}

model Modelo {
  id_modelo         Int                 @id @default(autoincrement())
  fecha_de_creacion DateTime            @default(now())
  archivo           String?
  correo_creador    String
  correo_empresa    String
  correo_cliente    String
  creador           Creador             @relation(fields: [correo_creador], references: [correo_creador])
  empresa           Empresa             @relation(fields: [correo_empresa], references: [correo_empresa])
  cliente           Cliente             @relation(fields: [correo_cliente], references: [correo_cliente])
  Edicion           Edicion[]
  EditoresDeModelos EditoresDeModelos[]
  Peticion          Peticion[]
}

model Edicion {
  id_modelo             Int
  correo_empleado       String
  fecha_de_modificacion DateTime @default(now())
  archivo               Bytes
  modelo                Modelo   @relation(fields: [id_modelo], references: [id_modelo])
  empleado              Empleado @relation(fields: [correo_empleado], references: [correo_empleado])

  @@id(name: "id_edicion", [id_modelo, correo_empleado, fecha_de_modificacion])
}

model EditoresDeModelos {
  correo_editor String
  id_modelo     Int
  modelo        Modelo @relation(fields: [id_modelo], references: [id_modelo])
  editor        Editor @relation(fields: [correo_editor], references: [correo_editor])

  @@id(name: "id_editores_de_modelos", [correo_editor, id_modelo])
}

model Peticion {
  correo_cliente   String
  id_modelo        Int
  fecha_de_emision DateTime @default(now())
  contenido        String
  estatus          Boolean
  cliente          Cliente  @relation(fields: [correo_cliente], references: [correo_cliente])
  modelo           Modelo   @relation(fields: [id_modelo], references: [id_modelo])

  @@id(name: "id_peticion", [correo_cliente, id_modelo, fecha_de_emision])
}
